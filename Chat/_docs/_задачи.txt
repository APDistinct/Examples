1. Тесты для NewMessageStrategy с фейковым DeepLink обработчиком
2. Тесты для DeepLink обработчиков
3. NewMessageStrategy: взаимодейтсвие временного юзера и юзера из DeepLink обработчика
4. Сделать тэг для подстановки кода WebChat DeepLink в сообщение, при это на всю веб-чат рассылку формировать одно сообщение со множеством адресатов.
5. Тест на триггер [Msg].[MessageToUser_OnInsert_WebChat], что ссылки при массовой рассылке в тексте СМС разные
6. надо сделать при загрузке файла в сообщении поле имя файла обязательное, обязательно наличие расширения. И запретить метод отдельной загрузки файла, который у нас POST files
7. Доработка механизма выяснения типа файла по расширению и сигнатуре
8. Хранение внешних идентификаторов файлов. Повторный посыл файла по идентификатору, при получении файла из мессенджеров проверка наличия уже загруженного
9. Переносы строк при рассылки email
10. Чтение/сохранение содерджимого файла из БД оформить как стратегию и везде использовать
11. Показ картинок как картинок в шаблоне для почты
12. Замена тэгов в сообщении, показываемом в веб-чате
13. Тест на ошибку в конвеере, когда отправитель вываливает исключение до старта потока. а также исключение в компилере
14. Исправить ошибку при формировании текста смс для веб-чата, когда имя отправителя пустое
15. Регистрировать в БД приветственное сообщение вайбера
16. Изменять статусы у приветственного сообщения вайбера (приходит delivered и пр)
17. И надо в протокол добавить две колонки: время поступления запроса и время завершения обработки
18. История изменения broadcast_prohibition
19. История изменения профиля


1. Профиль пользователя
    е. (НВ) Создание тригеров при вставке/обновлении/удалении аватара - событие об оповещении (всем слать или не всем?)
    ж. Флаг ментор или нет (OwnerUser = запрашиваемого юзера)
    з. Из моей структуры или нет (глубина). нужна ХП
2. БД
    в. добавить триггер: удалять часового (UserSentry) если юзер становится не активным
    г. добавить триггер: вставлять часового, только если юзер активен, и не бот, и не временный
3. Отправка сообщений
    в. ДБ: Создание события о удалении сообщения (двухфазовое удаление для внешних сообщений?)
    е. Команда удаления сообщения
    и. Улучшить ситуацию с непрочитанными/прочитаными сообшениями (хранить последнее, установка прочитанного сообщения делает прочитанными все предыдущие с этого канала, настройки по каналам, всё обдумать)
    к. Шаблоны сообщение
        к1. Обновить форматирование сообщения в CallbackSelectAddressee    
4. Получение обновлений о событиях
    д. Тест на то, что события для системного бота не генерируются
5. Запрос истории сообщений
    б. Одного сообщения
    д. История сообщений отправленных в сегмент для пользователя
6. Авторизаций через номер телефона    
    ж. Выкидывать из номера лишние символы
    з. В ответе время жизни СМС
7. ВКонтакте
8. Одноклассники
9. Telegram
    б. Ошибочные случае - в процессе
    г. Отправка сообщений одному пользователю - лимит по времени
    к. Сделать базовый класс для вебхука и тесты для него
    л. Учесть ситуацию повторного приёма сообщения
    м. При объединении пользователей перенаправлять старые сообщения на адресата для нового пользователя
    л. Проверить слияние пользователей на живом телеграмме. такое чувство, что сливает с другим юзером
    о. Сообщение о Callback смене адресата делать ответом на инициирующее сообщение
10. Viber
11. WhatsApp
12. Система ПАРТНЁР
15. Группы
    1. создание группы со списком участников
    2. добавление в группу (списком)
    3. удаление из группы (списком)
    4. выход их группы
    5. получение групп, в которых состоит
    6. получение участников группы (для тех, кто состоит)
    7. Смена статуса участника группы (админство)
    8. (НВ) группа распадается, когда в ней остаётся один участник. -- Нет, когда он подаст заявление на выход, т.е. останется 0. Либо когда удаляется последний админ, если он не назначил себе преемника.
    9. Расформирование группы (или это = удалению из группы всех?) -- не обязательно. Может поступить запрос о ликвидации без списка, а это придётся делать нам, удаляя всех, кто в ней есть и рассылая уведомления об этом. 
    10. (НВ) События о добавлении в/удалении из группы
16. Групповые сообщения FLChat -> FLChat
17. Сегменты
    е. Событие о изменение структуры сегмента    
18. Протоколирование
    а. Протоколирование запросов и ответов к серверу
19. Транспорт и общий процесс
    б. Отказаться от вторичного ключа между таблицами Message(ToUser) и Usr.Transport, не хранить тип транспорта WebChat, Sms и Email, сделать уникальный индекс на ид транспорта в независимости от поля Enabled. Удалять каналы а не деактивировать.
    в. Отправлять сообщение о том, что привязка через DeepLink не сработала
19, Организация обмена файлами.
    *а. Создание БД и таблиц
    *б. Доработка структуры имеющихся таблиц
    в. Процедуры чтения-записи файлов
    г. Определение типа принимаемого файла
    д. Дополнение таблицы типов медиа новыми данными
    *е. Доработка алгоритмов обмена сообщениями для включения передаваемых файлов
    ж. Дополнительные команды приёма и отправки файла
21. Работа с Девино. Сделать разбивку пакетов на отправку по количеству адресатов, не превышающих лимит. В данный момент(20190926) это 2999 штук.

